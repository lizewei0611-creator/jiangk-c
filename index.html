<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>桨刻赛事 · 发现与报名</title>
    <link rel="stylesheet" href="./assets/styles.css" />
    <style>
      /* 补充轻样式 */
      .hero {
        padding: 40px 0 20px;
      }
      .hero h1 {
        margin: 0 0 8px;
        font-size: 32px;
      }
      .hero .lead {
        color: var(--muted);
        margin: 0;
      }
      .actions {
        display: flex;
        gap: 12px;
        margin-top: 14px;
      }

      .cards.grid {
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      }
      .event-card {
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 12px;
        background: rgba(255, 255, 255, 0.03);
        display: grid;
        gap: 8px;
        transition: 0.15s ease;
      }
      .event-card:hover {
        transform: translateY(-2px);
        background: rgba(255, 255, 255, 0.06);
      }
      .event-cover {
        border-radius: 10px;
        overflow: hidden;
        border: 1px solid var(--border);
      }
      .event-title {
        font-weight: 800;
      }
      .event-meta {
        color: var(--muted);
        font-size: 14px;
      }
      .event-actions {
        display: flex;
        gap: 8px;
      }

      .timeline {
        display: grid;
        gap: 12px;
      }
      .time-item {
        display: flex;
        gap: 12px;
        align-items: center;
        padding: 10px;
        border: 1px solid var(--border);
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.03);
      }
      .time-badge {
        width: 64px;
        text-align: center;
        font-weight: 700;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 6px 8px;
      }
      .gallery {
        display: grid;
        gap: 10px;
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      }
      .gallery img {
        border-radius: 10px;
        border: 1px solid var(--border);
      }

      /* FAQ 列表 */
      .faq .q {
        font-weight: 700;
      }
      .faq .a {
        color: var(--muted);
      }

      /* 顶部导航更像门户而不是后台 */
      .brand img {
        border-radius: 8px;
        border: 1px solid var(--border);
      }
    </style>
  </head>
  <body>
    <!-- 顶部导航（C 端） -->
    <header class="site-header">
      <div class="container">
        <a class="brand" href="./">
          <img src="https://picsum.photos/seed/brand/36/36" alt="logo" />
          <span>桨刻赛事</span>
        </a>
        <nav class="nav">
          <a href="./index.html" class="active">发现</a>
          <a href="#schedule">赛程</a>
          <a href="#rank">榜单</a>
          <a href="#media">精彩瞬间</a>
          <!-- B 端入口弱化放到右侧或页脚 -->
          <a
            href="http://localhost:5174/"
            class="badge"
            target="_blank"
            rel="noopener"
            >赛事方入口</a
        </nav>
      </div>
    </header>

    <main class="container">
      <!-- 首屏主视觉：C 端语气 -->
      <section class="hero">
        <h1>发现附近的龙舟赛事，立即报名参赛</h1>
        <p class="lead">官方赛历 · 实时成绩 · 电子证书 · 精彩集锦</p>
        <div class="actions">
          <a class="btn primary" href="#hot">立即报名</a>
          <a class="btn" href="#schedule">查看赛程</a>
        </div>
      </section>

      <!-- 精选赛事 -->
      <section id="hot" class="card">
        <h2>精选赛事</h2>
        <div id="events" class="cards grid"></div>
        <small class="muted">更多赛事正在更新中</small>
      </section>

      <!-- 即将开赛（时间轴） -->
      <section id="schedule" class="card">
        <h2>即将开赛</h2>
        <div id="upcoming" class="timeline">
          <!-- JS 动态填充 -->
        </div>
      </section>

      <!-- 冠军榜单 -->
      <section id="rank" class="card">
        <h2>最新榜单</h2>
        <div class="table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th>排名</th>
                <th>队伍</th>
                <th>项目</th>
                <th>成绩</th>
                <th>赛事</th>
              </tr>
            </thead>
            <tbody id="rank-body"></tbody>
          </table>
        </div>
      </section>

      <!-- 媒体画廊 -->
      <section id="media" class="card">
        <h2>精彩瞬间</h2>
        <div class="gallery" id="gallery">
          <img src="https://picsum.photos/seed/d1/640/400" alt="gallery" />
          <img src="https://picsum.photos/seed/d2/640/400" alt="gallery" />
          <img src="https://picsum.photos/seed/d3/640/400" alt="gallery" />
          <img src="https://picsum.photos/seed/d4/640/400" alt="gallery" />
        </div>
      </section>

      <!-- FAQ（用户侧） -->
      <section class="card faq">
        <h2>常见问题</h2>
        <div class="list">
          <div class="item">
            <div class="q">如何报名参赛？</div>
            <div class="a">
              在精选赛事中选择赛事，点击“报名”，按指引填写信息并完成缴费即可。
            </div>
          </div>
          <div class="item">
            <div class="q">成绩如何查询？</div>
            <div class="a">
              赛后可在赛事详情页查看实时成绩与电子证书，也可以在“榜单”模块查看。
            </div>
          </div>
          <div class="item">
            <div class="q">退款与改签规则？</div>
            <div class="a">
              以各赛事公告为准，报名页将清晰展示退款与改签规则。
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container">
        <span class="muted">© 2025 桨刻 · 由赛事与龙舟社区共同维护</span>
      </div>
    </footer>

    <script>
      // 轻 JS：把原有数据渲染成更“C 端”的卡片与时间轴
      async function j(url) {
        const r = await fetch(url, { cache: "no-store" });
        if (!r.ok) throw new Error(r.status + " " + url);
        return r.json();
      }
      function E(t, c, txt) {
        const n = document.createElement(t);
        if (c) n.className = c;
        if (txt != null) n.textContent = txt;
        return n;
      }

      // 精选赛事 -> 卡片
      async function loadEvents() {
        const root = document.getElementById("events");
        root.innerHTML = "";
        try {
          const list = await j("./data/events.json");
          if (!Array.isArray(list) || !list.length) {
            root.appendChild(E("div", "empty", "近期暂无赛事，敬请期待"));
            return;
          }
          list.slice(0, 6).forEach((e, idx) => {
            const card = E("div", "event-card");
            const cover = E("div", "event-cover");
            const img = new Image();
            img.src = e.cover || `https://picsum.photos/seed/ev${idx}/640/360`;
            img.alt = e.title || "赛事封面";
            cover.appendChild(img);
            card.appendChild(cover);

            card.appendChild(E("div", "event-title", e.title || "未命名赛事"));
            card.appendChild(
              E(
                "div",
                "event-meta",
                [e.date, e.location].filter(Boolean).join(" · ") ||
                  "时间待定 · 地点待定"
              )
            );

            const actions = E("div", "event-actions");
            const btnPrimary = E("a", "btn primary", e.signupText || "报名");
            btnPrimary.href = e.link || "#";
            const btnGhost = E("a", "btn", "详情");
            btnGhost.href = e.link || "#";
            actions.append(btnPrimary, btnGhost);

            card.appendChild(actions);
            root.appendChild(card);
          });
        } catch (err) {
          root.appendChild(E("div", "error", "加载失败：" + err.message));
        }
      }

      // 即将开赛 -> 时间轴（从 events.json 推断）
      async function loadUpcoming() {
        const root = document.getElementById("upcoming");
        root.innerHTML = "";
        try {
          const list = await j("./data/events.json");
          const upcoming = (Array.isArray(list) ? list : [])
            .filter((e) => e.date)
            .slice(0, 5);

          if (!upcoming.length) {
            root.appendChild(E("div", "empty", "暂无即将开赛的项目"));
            return;
          }

          upcoming.forEach((e) => {
            const item = E("div", "time-item");
            const dt = new Date(e.date);
            const badge = E(
              "div",
              "time-badge",
              `${String(dt.getMonth() + 1).padStart(2, "0")}/${String(
                dt.getDate()
              ).padStart(2, "0")}`
            );
            const info = E("div", "");
            info.appendChild(E("div", "", e.title || "未命名赛事"));
            info.appendChild(E("div", "muted", e.location || "地点待定"));
            item.append(badge, info);
            root.appendChild(item);
          });
        } catch (err) {
          root.appendChild(E("div", "error", "加载失败：" + err.message));
        }
      }

      // 榜单 -> 使用 achievements_me.json 简单演示
      async function loadRank() {
        const tbody = document.getElementById("rank-body");
        tbody.innerHTML = "";
        try {
          const list = await j("./data/achievements_me.json");
          if (!Array.isArray(list) || !list.length) {
            const tr = document.createElement("tr");
            const td = document.createElement("td");
            td.colSpan = 5;
            td.className = "muted";
            td.textContent = "暂无榜单数据";
            tr.appendChild(td);
            tbody.appendChild(tr);
            return;
          }
          list.slice(0, 8).forEach((a, i) => {
            const tr = document.createElement("tr");
            const cols = [
              a.rank || i + 1,
              a.team || a.event || "队伍",
              a.category || "项目",
              a.result || "-",
              a.event || "-",
            ];
            cols.forEach((txt) => {
              const td = document.createElement("td");
              td.textContent = txt;
              tr.appendChild(td);
            });
            tbody.appendChild(tr);
          });
        } catch (err) {
          const tr = document.createElement("tr");
          const td = document.createElement("td");
          td.colSpan = 5;
          td.textContent = "加载失败：" + err.message;
          tr.appendChild(td);
          tbody.appendChild(tr);
        }
      }

      loadEvents();
      loadUpcoming();
      loadRank();
    </script>
  </body>
</html>
